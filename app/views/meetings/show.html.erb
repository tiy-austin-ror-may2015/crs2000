<div class="container">
  <div class="row">
    <p id="notice" class="alert"><%= notice %></p>
    <p style='color:red;'><%= flash[:alert] %></p>

<div>
    <div class="col-md-12">
      <h2><%= @meeting.title.capitalize %></h2>
      <div class="meeting-buttons">
        <%= link_to 'Join', join_employee_path(@meeting.id), method: 'POST', class: 'btn btn-default join-button' %>
        <%= link_to 'Edit', edit_meeting_path(@meeting), class: "btn btn-default" %>
        <%= link_to 'Back to Meetings', meetings_path, class: "btn btn-default" %>
      </div>


    <div class="col-md-5">
      <h3>Meeting Details:</h3>
          <strong>Location:</strong> <p><%= link_to @meeting.room.name, @meeting.room %></p>
          <strong>Start time:</strong><p class="timeDisplay"> <%= @meeting.start_time %></p>
          <strong>End time:</strong><p class="timeDisplay"> <%= @meeting.end_time %></p>
          <strong>Max Occupancy:</strong><p> <%= @max_occupancy %></p>
    </div>

    <div class="col-md-6 col-md-offset-1">
      <h3>Agenda:</h3>
      <div>
        <p><%= @meeting.agenda %></p>
      </div>
    </div>

  <row>
    <div class="col-md-6 col-md-offset-1">
      <h3>Attending(<%=@attendees.count%>):</h3>
      <ul>
        <% @attendees.each do |attendee| %>
            <li><%= link_to attendee.name, attendee %></li>
        <% end %>

      </ul>
    </div>
  </row>

  </div>
  </div>


  <% if @meeting_owner == true %>
  <div class="row">
    <br>
    <br>
    <h2>Invite Employees</h2>
    <p><strong>Company: </strong><%= link_to @invitees[0].company.name, @invitees[0].company %> </p>
    <% if @invitees.count > 0 %>
        <div class="well center" style="width:50%">
            <input type='text' id='search' placeholder="name" />
            <script>
              $("#search").on("keyup paste change", function(){
                  var re = new RegExp(this.value,"i");
                  $("#invitees tr").each(function(index){
                      var invitee_name = $("#invitee_name", this).html();
                      this.hidden = ! re.test(invitee_name);
                  });
              });
            </script>
        </div>





        <table class="table" style="width:50%">
          <thead>
          <tr>
            <th>Invite?</th>
            <th>Employee</th>
          </tr>
          </thead>
          <tbody id="invitees">
            <% @invitees.each do |invitee|%>
            <tr>
              <td>
                <% if invitee.invitations.where(meeting_id: @meeting.id).exists? %>
                    <br><p style="font-style: italic">Already invited!</p>
                <% else %>
                    <%= link_to 'Invite', send_invitation_path(@meeting.id, invitee.id), method: 'POST', class: 'btn btn-default' %>
                <% end %>
              </td>
              <td>
                <h5><strong id="invitee_name"><%= invitee.name %></strong></h5>
                <p><strong>Email: </strong><%= invitee.email %></p>
              </td>
            </tr>
            <%end %>
          </tbody>
        </table>
    <% else %>
        <p>There is no-one to invite.</p>
    <% end %>
  </div>
  <% end %>
</div>
</div>

